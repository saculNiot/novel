'use client'
var j=Object.create;var p=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var ne=(e,o)=>{for(var t in o)p(e,t,{get:o[t],enumerable:!0})},x=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of te(o))!re.call(e,n)&&n!==t&&p(e,n,{get:()=>o[n],enumerable:!(r=ee(o,n))||r.enumerable});return e};var a=(e,o,t)=>(t=e!=null?j(oe(e)):{},x(o||!e||!e.__esModule?p(t,"default",{value:e,enumerable:!0}):t,e)),ie=e=>x(p({},"__esModule",{value:!0}),e);var xe={};ne(xe,{AIHighlight:()=>me,Command:()=>ue,HorizontalRule:()=>Re,ImageResizer:()=>k,InputRule:()=>R.InputRule,Placeholder:()=>he,StarterKit:()=>$.default,TaskItem:()=>V.TaskItem,TaskList:()=>G.TaskList,TiptapImage:()=>B.default,TiptapLink:()=>q.default,UpdatedImage:()=>b,addAIHighlight:()=>ce,createSuggestionItems:()=>ge,getPrevText:()=>O,handleCommandNavigation:()=>fe,inputRegex:()=>S,pasteRegex:()=>H,removeAIHighlight:()=>de,renderItems:()=>pe,simpleExtensions:()=>ye});module.exports=ie(xe);var $=a(require("@tiptap/starter-kit"),1),U=a(require("@tiptap/extension-horizontal-rule"),1),q=a(require("@tiptap/extension-link"),1),B=a(require("@tiptap/extension-image"),1),W=a(require("@tiptap/extension-placeholder"),1),F=a(require("@tiptap/extension-underline"),1),_=a(require("@tiptap/extension-text-style"),1),Q=require("@tiptap/extension-color"),V=require("@tiptap/extension-task-item"),G=require("@tiptap/extension-task-list"),R=require("@tiptap/core"),J=require("tiptap-markdown"),X=a(require("@tiptap/extension-highlight"),1);var C=a(require("@tiptap/extension-image"),1),ae=C.default.extend({name:"image",addAttributes(){return{...this.parent?.(),width:{default:null},height:{default:null}}}}),b=ae;var E=require("@tiptap/core"),se=E.Extension.create({name:"CustomKeymap",addCommands(){return{selectTextWithinNodeBoundaries:()=>({editor:e,commands:o})=>{let{state:t}=e,{tr:r}=t,n=r.selection.$from.start(),i=r.selection.$to.end();return o.setTextSelection({from:n,to:i})}}},addKeyboardShortcuts(){return{"Mod-a":({editor:e})=>{let{state:o}=e,{tr:t}=o,r=t.selection.from,n=t.selection.to,i=t.selection.$from.start(),c=t.selection.$to.end();return r>i||n<c?(e.chain().selectTextWithinNodeBoundaries().run(),!0):!1}}}}),T=se;var I=a(require("react-moveable"),1),A=require("@tiptap/react"),w=require("react/jsx-runtime"),k=()=>{let{editor:e}=(0,A.useCurrentEditor)();if(!e?.isActive("image"))return null;let o=()=>{let t=document.querySelector(".ProseMirror-selectednode");if(t){let r=e.state.selection,n=e.commands.setImage;n({src:t.src,width:Number(t.style.width.replace("px","")),height:Number(t.style.height.replace("px",""))}),e.commands.setNodeSelection(r.from)}};return(0,w.jsx)(I.default,{target:document.querySelector(".ProseMirror-selectednode"),container:null,origin:!1,edge:!1,throttleDrag:0,keepRatio:!0,resizable:!0,throttleResize:0,onResize:({target:t,width:r,height:n,delta:i})=>{i[0]&&(t.style.width=`${r}px`),i[1]&&(t.style.height=`${n}px`)},onResizeEnd:()=>{o()},scalable:!0,throttleScale:0,renderDirections:["w","e"],onScale:({target:t,transform:r})=>{t.style.transform=r}})};var Y=a(require("tiptap-extension-global-drag-handle"),1),Z=a(require("tiptap-extension-auto-joiner"),1);var s=require("@tiptap/core"),S=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,H=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,me=s.Mark.create({name:"ai-highlight",addOptions(){return{HTMLAttributes:{}}},addAttributes(){return{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",(0,s.mergeAttributes)(this.options.HTMLAttributes,e),0]},addCommands(){return{setAIHighlight:e=>({commands:o})=>o.setMark(this.name,e),toggleAIHighlight:e=>({commands:o})=>o.toggleMark(this.name,e),unsetAIHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleAIHighlight()}},addInputRules(){return[(0,s.markInputRule)({find:S,type:this.type})]},addPasteRules(){return[(0,s.markPasteRule)({find:H,type:this.type})]}}),de=e=>{let o=e.state.tr;o.removeMark(0,e.state.doc.nodeSize-2,e.state.schema.marks["ai-highlight"]),e.view.dispatch(o)},ce=(e,o)=>{e.chain().setAIHighlight({color:o??"#c1ecf970"}).run()};var z=require("@tiptap/core"),L=a(require("@tiptap/suggestion"),1),K=require("@tiptap/react"),D=a(require("tippy.js"),1);var u=require("jotai"),m=require("react"),g=require("cmdk");var f=require("jotai"),h=(0,f.atom)(""),v=(0,f.atom)(null);var P=require("jotai"),y=(0,P.createStore)();var d=require("react/jsx-runtime"),M=(0,m.createContext)({}),N=({query:e,range:o})=>{let t=(0,u.useSetAtom)(h,{store:y}),r=(0,u.useSetAtom)(v,{store:y});return(0,m.useEffect)(()=>{t(e)},[e,t]),(0,m.useEffect)(()=>{r(o)},[o,r]),(0,m.useEffect)(()=>{let n=["ArrowUp","ArrowDown","Enter"],i=c=>{if(n.includes(c.key)){c.preventDefault();let l=document.querySelector("#slash-command");return l&&l.dispatchEvent(new KeyboardEvent("keydown",{key:c.key,cancelable:!0,bubbles:!0})),!1}};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[]),(0,d.jsx)(M.Consumer,{children:n=>(0,d.jsx)(n.Out,{})})},le=(0,m.forwardRef)(({children:e,className:o,...t},r)=>{let[n,i]=(0,u.useAtom)(h);return(0,d.jsx)(M.Consumer,{children:c=>(0,d.jsx)(c.In,{children:(0,d.jsxs)(g.Command,{ref:r,onKeyDown:l=>{l.stopPropagation()},id:"slash-command",className:o,...t,children:[(0,d.jsx)(g.Command.Input,{value:n,onValueChange:i,style:{display:"none"}}),e]})})})}),Pe=g.Command.List;le.displayName="EditorCommand";var ue=z.Extension.create({name:"slash-command",addOptions(){return{suggestion:{char:"/",command:({editor:e,range:o,props:t})=>{t.command({editor:e,range:o})}}}},addProseMirrorPlugins(){return[(0,L.default)({editor:this.editor,...this.options.suggestion})]}}),pe=()=>{let e=null,o=null;return{onStart:t=>{e=new K.ReactRenderer(N,{props:t,editor:t.editor});let{selection:r}=t.editor.state;if(r.$from.node(r.$from.depth).type.name==="codeBlock")return!1;o=(0,D.default)("body",{getReferenceClientRect:t.clientRect,appendTo:()=>document.body,content:e.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate:t=>{e?.updateProps(t),o&&o[0].setProps({getReferenceClientRect:t.clientRect})},onKeyDown:t=>t.event.key==="Escape"?(o?.[0].hide(),!0):e?.ref?.onKeyDown(t),onExit:()=>{o?.[0].destroy(),e?.destroy()}}},ge=e=>e,fe=e=>{if(["ArrowUp","ArrowDown","Enter"].includes(e.key)&&document.querySelector("#slash-command"))return!0};var Le=require("@tiptap/core");var O=(e,{chars:o,offset:t=0})=>e.storage.markdown.getMarkdown();var he=W.default.configure({placeholder:({node:e})=>e.type.name==="heading"?`Heading ${e.attrs.level}`:"Press '/' for commands",includeChildren:!0}),ye=[F.default,_.default,Q.Color,X.default.configure({multicolor:!0}),J.Markdown.configure({transformPastedText:!0}),T,Y.default.configure({scrollTreshold:0}),Z.default],Re=U.default.extend({addInputRules(){return[new R.InputRule({find:/^(?:---|â€”-|___\s|\*\*\*\s)$/u,handler:({state:e,range:o})=>{let t={},{tr:r}=e,n=o.from,i=o.to;r.insert(n-1,this.type.create(t)).delete(r.mapping.map(n),r.mapping.map(i))}})]}});0&&(module.exports={AIHighlight,Command,HorizontalRule,ImageResizer,InputRule,Placeholder,StarterKit,TaskItem,TaskList,TiptapImage,TiptapLink,UpdatedImage,addAIHighlight,createSuggestionItems,getPrevText,handleCommandNavigation,inputRegex,pasteRegex,removeAIHighlight,renderItems,simpleExtensions});
